<!doctype html>
<html>
    <head>
        <meta charset="utf-8">
        <link rel="stylesheet" href="css/bootstrap.css" media="screen"/>
        <link rel="stylesheet" href="css/bootstrap-responsive.css"/>
        <link rel="stylesheet" href="css/style.css"/>
        <link rel="stylesheet" href="img/glyphicons-halflings.png"/>
        <script type="text/javascript" src="js/jquery-1.9.1.min.js"></script>
        <script type="text/javascript" src="js/bootstrap.js"></script>
       <!-- <script type="text/javascript" src="jquery.carouFredSel-6.2.0.js"></script> -->
         <!-- <script type="text/javascript" src="http://jzaefferer.github.com/jquery-validation/jquery.validate.js"></script> -->    
    </head>
    <body>
<div class="navbar navbar-inverse navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container">
          <button type="button" class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="brand" href="#">Bootstrap Exercise</a>
          <div class="nav-collapse collapse">
            <ul class="nav">
              <li class="active"><a href="#">Home</a></li>
              <li><a href="#about">About</a></li>
              <li><a href="#contact">Contact</a></li>
              <li class="dropdown">
                <a href="#" class="dropdown-toggle" data-toggle="dropdown">Dropdown <b class="caret"></b></a>
                <ul class="dropdown-menu">
                  <li><a href="#">Action</a></li>
                  <li><a href="#">Another action</a></li>
                  <li><a href="#">Something else here</a></li>
                  <li class="divider"></li>
                  <li class="nav-header">Nav header</li>
                  <li><a href="#">Separated link</a></li>
                  <li><a href="#">One more separated link</a></li>
                </ul>
              </li>
            </ul>
            <form class="navbar-form pull-right">
              <input class="span2" type="text" placeholder="Email">
              <input class="span2" type="password" placeholder="Password">
              <button type="submit" class="btn">Sign in</button>
            </form>
          </div><!--/.nav-collapse -->
        </div>
      </div>
    </div> <!--navbar-->
    <div class="container windowpane">
        <div class="hero-unit">
            <div class="row">
                <div class="span12 maintext">
                    <!-- <h1>Beer League Baseball!</h1>
                    <h3>There's No Crying in Baseball!....But there is BEER!!!</h3>
                    <p>It's that time of year again. Who doesn't love BEER and BASEBALL? Join our league today for FREE. Weekly matchups with other fanatics here in Nashville.</p><p>Serious people need not apply...</p> -->
                    
                    <a href="#myModal" role="button" class="btn" id="launch" data-toggle="modal">SIGN UP TODAY</a>
                    <!-- Modal -->
                    <div id="myModal" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
                      <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">X</button>
                        <h3 id="myModalLabel">Team Registration Form</h3>
                      </div>
                      
                      <form class="form-horizontal" id="signup">
                        <fieldset>
     <legend>Registraion</legend>
                            <label>Team Name</label>
    <input type="text" id="teamName" name = "teamName" placeholder="Team Name" value="">
      <label>Manager Name</label>
        <input id="mgrFirst" name = "mgrFirst" type="text" placeholder="First Name" value="">
      <input id="mgrLast" name = "mgrLast" type="text" placeholder="Last Name" value="">
      <label>Manager Phone Number</label>
      <input type="text" id="phone" name = "phone"placeholder="Phone Number" value="">
    <label>Manager Zip Code</label>
    <input type="text" id="zip" name = "zip"placeholder="Zip Code" value="">
  <label>Sponsor</label>
  <input type="text" id="sponsor" name = "sponsor" placeholder="Team Sponsor" value=""></br>
  
  <!-- <INPUT TYPE="button" button id= "registerTeam" NAME="button" Value="Submit" onClick="registerTeam(this.form)"> -->

  <button id ="registerTeam" button type="button" name="button" class="btn">Register Team</button>
  <div id="registerTeam"</div>
  </form>
                    </div>
                    <div id="teamdisplay"></div>  
                </div>
            </div>
          <!-- <div class="alert alert-error">
              <button type="button" class="close" data-dismiss="alert">&times;</button>
              <strong>Don't Wait!</strong> Registration will close on Feb 28th!
          </div>  -->
        </div>
        <!-- <div class="row">
            <div class="span12 box what1">
                <div class="image_carousel">
                  <div id="foo1">
                      <img src="img/logo1.jpg" alt="basketball" width="225" height="140" />
                      <img src="img/logo2.jpg" alt="beachtree" width="225" height="140" />
                      <img src="img/logo3.jpg" alt="cupcackes" width="225" height="140" />
                      <img src="img/logo4.jpg" alt="hangmat" width="225" height="140" />
                      <img src="img/logo5.jpg" alt="new york" width="225" height="140" />
                      <img src="img/logo6.jpg" alt="new york" width="225" height="140" />
                  </div>
                  <div class="clearfix"></div>
                </div>
            </div>
        </div> -->
        

        <div class="row">

          <!---Start Team List -->
            <div class="span8 box three">   
                <table class="table" id="standings">                  
                  <tr>
                    <th>Team</th>
                    <th>Wins</th>
                    <th>Losses</th>
                    <th>Win %</th>
                  </tr>

                  <tr>

                    <td id ="team1">Team 1</td>

                    <td>0</td>
                    <td>0</td>
                    <td>.000</td>
                  </tr>


                  <tr>
                    <td id ="team2">Team 2</td>
                    <td>0</td>
                    <td>0</td>
                    <td>.000</td>
                  </tr>
                  

                  <tr>
                    <td id= "team3">Team 3</td>
                    <td>0</td>
                    <td>0</td>
                    <td>.000</td>
                  </tr>
                  

                  <tr>
                    <td id = "team4">Team 4</td>
                    <td>0</td>
                    <td>0</td>
                    <td>.000</td>
                  </tr>
                  

                  <tr>
                    <td id = "team5">Team 5</td>
                    <td>0</td>
                    <td>0</td>
                    <td>.000</td>
                  </tr>
                  

                  <tr>
                    <td id = "team6">Team 6</td>
                    <td>0</td>
                    <td>0</td>
                    <td>.000</td>
                  </tr>
                  

                  <tr>
                    <td id ="team7">Team 7</td>
                    <td>0</td>
                    <td>0</td>
                    <td>.000</td>
                  </tr>
                  

                  <tr>
                    <td id="team8">Team 8</td>
                    <td>0</td>
                    <td>0</td>
                    <td>.000</td>
                  </tr>
                </table>
              
            </div>
            <!-------End Team List -->

            
                <p><a class="btn" id="startSeason">Start Season</a></p>
            </div>
        </div>
        <div class="row">
          <div class="span6 box">
             <div id="gameschedule" class="tab-pane hero-unit gameschedule">
            
                <h3>Schedule</h3>
                <p class="matchups">Who's Playing Who?</p>
                <table id="scheduleTable">
                  
                </table>
             </div> <!-- End Schedule Tab -->
          </div>
         </div> 
        <div class="row">
            <div class="span12 box newsletter">
                <h4>Sign up for our newsletter</h4>
                <div class="control-group">
                  <label class="control-label" for="inputIcon">Email address</label>
                  <div class="controls">
                    <div class="input-prepend">
                      <span class="add-on"><i class="icon-envelope"></i></span>
                      <input class="span2" id="inputIcon" type="text">
                    </div>
                  </div>
                </div>
            </div>
        </div>
        <footer>
            <p>Â© Company 2013</p>
        </footer>
    </div>
    <script>
           
 $(document).ready(function(){
  
              //form validation
              // $("#commentForm").validate();

var allTeams = new Array (); //declaring array for all teams in league


$('#registerTeam').click(function() {
 var team = { };
  team.teamName = $("#teamName").val();
  team.mgrFirst = $("#mgrFirst").val();
  team.mgrLast = $("#mgrLast").val();
  team.phone = $("#phone").val();
  team.zip = $("#zip").val();
  team.sponsor = $("#sponsor").val();
  team.wins = 0;
  team.losses = 0;
  console.log(team);

  $.ajax({
    // url: "/backliftapp/team",
    url: "/backliftapp/newTeam",
    type: "post",
    dataType: "JSON",
    data:team, // this line is the objcet name that i am sending to the server//
    success: function(data){
      console.log(data);
      allTeams.push(data); //pushing all info into main allTeams array created at top
      //this is where I need to add the info to the page
       //recommended to call another function to add the data to another page
      
    },
    error: function(){
      console.log("There was an error");
    }
  }); //end of ajax "post"

  $("#signup")[0].reset(); //resets form after each time register is clicked



}); //end click

function listTeams(){
 $.ajax({
    // url: "/backliftapp/team",
    url: "/backliftapp/newTeam",
    type: "GET",
    success: function(data) {
      var i=1; 
      $.each(data,function() {
        $("#team" +i).html("<a rel='popover' class='show'>" + this.teamName +"</a>"+"<p class='more'><br>"+
          "Manager: " + this.mgrFirst + " " + this.mgrLast + "<br>" +
          "Phone: " + this.phone + "<br>" +
          "Sponsor: " + this.sponsor + "<br></p>"); i=i+1;
        console.log(this);
      }); //end each loop
      teamPopover(); //calling function..has to be after loop but before close of success function to work properly
    }, //end success function
  
    error: function(){
      console.log("There was an error");
    } //end error function 
  }) //end ajax get
} //end listTeams functionality


//Delete Team
$.ajax({
    type: "DELETE",
    url: "/backliftapp/newTeam/de9b443a-0787-440b-a3e2-acd1302415fb", 
    success: function(data) { 
        console.log("Deleted!");
    } //end success function
}); //end ajax DELETE
 //use this code to delete teams that have been entered - replace id number above with id number from ajax data file

listTeams();//calling listTeams




function teamPopover() { 
  $('.more').hide();
  $('.show').click(
  function () {
    $(this).next('.more').toggle();
  });
}//end teamPopover

// functionality of using the right schedule for the # of teams in league and populting schedule with actual team names
// event listener is #startSeason button on click
$('#startSeason').click(function(){
  $.ajax({
      // url: '/backliftapp/team',
      url: "/backliftapp/newTeam",
      type: "GET",
      dataType: 'json',
      success: function(data) {
      allTeams = data;
      populateSchedule(data);
     }//end success
  });//end Ajax get
});//end startSeason click

      //declaring schedule variables
      var sched4 = [ 
    [ [1, 4], [2, 3] ],
    [ [1, 3], [2, 4] ],
    [ [1, 2], [3, 4] ]
    ];

    var sched6 = [ 
    [ [1, 6], [2, 5], [3, 4] ],
    [ [1, 5], [4, 6], [2, 3] ],
    [ [1, 4], [3, 5], [2, 6] ],
    [ [1, 3], [2, 4], [5, 6] ],
    [ [1, 2], [3, 6], [4, 5] ],
    ];

    var sched8 = [
    [ [1, 8], [2, 7], [3, 6], [4, 5] ],
    [ [1, 7], [6, 8], [2, 5], [3, 4] ],
    [ [1, 6], [5, 7], [4, 8], [2, 3] ],
    [ [1, 5], [4, 6], [3, 7], [2, 8] ],
    [ [1, 4], [3, 5], [2, 6], [7, 8] ],
    [ [1, 3], [2, 4], [5, 8], [6, 7] ],
    [ [1, 2], [3, 8], [4, 7], [5, 6] ],
    ];//end schedule variables

function populateSchedule (d) {  // Note: (d) is from ajax "data", set equal to allTeams array in "get" above
      if (d.length === 4) {
        var s = sched4;
      } else if (d.length === 5 || d.length === 6) {
        var s = sched6;
      } else{
        var s = sched8;
      } //end schedule conditional based on # of teams

      //d-allTeams s-schedule w-weeks g-games 
      for (w = 0 ; w < s.length ; w++) {
        //if statement for even # of teams
        if (d.length%2 === 0){ 
              $('#scheduleTable').append("<tbody id='week" + w + "'class='tablehead'><tr><th>Week " + [w + 1] + "</th><th>Score" + "</th></tr></tbody>");
              
              for (g = 0 ; g < s[w].length; g++) {
                //setting values of home and away teams with teamName from allTeams(AKA "d")
                var awayTeam = d[s[w][g][0]-1].teamName 
                var homeTeam = d[s[w][g][1]-1].teamName
                awayScore = 0;
                homeScore = 0; 

                $("#week" + w).append("<tr><td>" + awayTeam + " vs. " + homeTeam + "</td><td class='inputScore' data-awayName='" + awayTeam + "' data-homeName='"+ homeTeam + "'><input type='num' size='2' maxlength='2' class='score-field score-home'/>-<input type='num' size='2' maxlength='2' class='score-field score-visitor'/></td><td class='enterscore'><a class='btn' id='" + w + "' href=''>Enter Score</a></td></tr>")
              }//end games loop

              

              
        } //end if statement for even # of teams


 else{
      var teamwithBye = d[s[w][0][1]-2].teamName
      $('#scheduleTable').append("<tbody id='week" + w + "'class='tablehead'><tr><th>Week " + [w + 1] + "<br/>" +teamwithBye + " have a Bye</th><th>Score" + "</th><th class='enterscore hidden-btn'>Update</th></tr></tbody>")

      for (g = 1 ; g < s[w].length; g++) {

      var awayTeam = d[s[w][g][0]-2].teamName 
      var homeTeam = d[s[w][g][1]-2].teamName
      awayScore = 0;
      homeScore = 0;     
      $("#week" + w).append("<tr><td>" + awayTeam + " vs. " + homeTeam + "</td><td class='inputScore' data-awayName='" + awayTeam + "' data-homeName='"+ homeTeam + "'><input type='num' size='2' maxlength='2' class='score-field score-home'/>-<input type='num' size='2' maxlength='2' class='score-field score-visitor'/></td><td class='enterscore'><a class='btn' id='" + w + "' href=''>Enter Score</a></td></tr>")

      }//end games(g) loop
    } // end ELSE loop for BYE WEEKS if odd # of teams in league
  }// end week(w) loop

//start score input function
var allScores = new Array (); //declaring array for all teams in league

  $('a.btn').click(function(ev){
    ev.preventDefault();
    
    var week = $(this).attr("id");
    //for (w = 1; w = ){
    //  ;
    //}


   
    var scoreHome = $(this).parent().prev().find('.score-home').val();
    var nameHome = $(this).parent().prev().data('homename');
    var scoreVisitor = $(this).parent().prev().find('.score-visitor').val();
    var nameAway = $(this).parent().prev().data('awayname');

    // scoreData = function(){ 
    //   this.scoreHome =$("scoreHome").val();
    //   this.scoreVisitor =$("scoreVisitor").val();
    // };
    console.log(nameHome);
    console.log(scoreHome);
    console.log(nameAway);
    console.log(scoreVisitor);

    // console.log(scoreData);
    // alert(scoreData);






}); //end score input click function

}// end populateSchedule
            




// $('.enterscore').click(function(){
//   var btn = $(this);
//   awayScore = $(".score-visitor").val();
//   homeScore = $(".score-home").val();
//                 var btn = $(this);

//                 btn.closest('tr')
//                 console.log(awayScore);
//                 console.log(homeScore);
//               }); //end click
//   console.log(btn);

//   // btn.closest('tr')
// // });

              

          
}); // end document.ready
          
      

        </script>
          </body>
          </html>